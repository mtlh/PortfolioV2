---
import { Image } from 'astro:assets';
import Icon from 'node_modules/astro-icon/components/Icon.astro';
import type ImageMetadata from 'astro:assets';

// Images
import pokeThumb from '~/assets/images/poke_extra_thumb.webp';
import orderMunchThumb from '~/assets/images/ordermunch_thumbnail.webp';
import telemetryThumb from '~/assets/images/telemetry_thumbnail.webp';

// Skill icons used in extras
import html5 from '~/assets/skills/icons/html5-original.svg';
import css3 from '~/assets/skills/icons/css3-original.svg';
import jsIcon from '~/assets/skills/icons/javascript-plain.svg';
import kotlinIcon from '~/assets/skills/icons/kotlin-original.svg';
import androidStudio from '~/assets/skills/icons/androidstudio-original.svg';
import sqliteIcon from '~/assets/skills/icons/sqlite-original.svg';
import gradleIcon from '~/assets/skills/icons/gradle-original.svg';
import phpIcon from '~/assets/skills/icons/php-plain.svg';
import mariadbIcon from '~/assets/skills/icons/mariadb-plain.png';
import slim4Icon from '~/assets/skills/icons/slim4-plain.jpg';
import phpstormIcon from '~/assets/skills/icons/phpstorm-plain.svg';
import filezillaIcon from '~/assets/skills/icons/filezilla-plain.svg';

type Skill = {
  src: ImageMetadata;
  label: string;
};

type Extra = {
  title: string;
  description: string;
  image: ImageMetadata;
  imageAlt: string;
  imageClass: string;
  liveUrl: string | null;
  githubUrl: string | null;
  skills: Skill[];
};

// Centralized extras data
const extras: Extra[] = [
  {
    title: 'Pokécenter',
    description:
      'Pokémon website interacting with pokéapi, using standard HTML/CSS/JS only. University module - Frontend Web Development.',
    image: pokeThumb,
    imageAlt: 'Pokécenter',
    imageClass: 'flex justify-center object-cover object-center rounded-lg w-[40%] h-full',
    liveUrl: 'https://mtlh-frontend-ctec-3905.vercel.app/',
    githubUrl: null, // https://github.com/mtlh/FrontendCTEC3905/
    skills: [
      { src: html5, label: 'HTML' },
      { src: css3, label: 'CSS' },
      { src: jsIcon, label: 'Javascript' },
    ],
  },
  {
    title: 'OrderMunch',
    description:
      'Cafe application built using Kotlin and Android Studio with functional admin interface. University module - Mobile App Development.',
    image: orderMunchThumb,
    imageAlt: 'OrderMunch',
    imageClass: 'flex justify-center object-cover object-center rounded-lg w-40 h-80',
    liveUrl: null,
    githubUrl: null, // https://github.com/mtlh/ordermunch/
    skills: [
      { src: kotlinIcon, label: 'Kotlin' },
      { src: androidStudio, label: 'Android Studio' },
      { src: sqliteIcon, label: 'SQLite' },
      { src: gradleIcon, label: 'Gradle' },
    ],
  },
  {
    title: 'Telemetry',
    description:
      'Website accessing EE web service for phone messaging, featuring 2FA text verification. University module - Secure Web Development.',
    image: telemetryThumb,
    imageAlt: 'Telemetry',
    imageClass: 'flex justify-center object-cover object-center rounded-lg w-40 h-80',
    liveUrl: null,
    githubUrl: null, // https://github.com/CTEC3110-BAM/Teledexpress
    skills: [
      { src: phpIcon, label: 'PHP' },
      { src: mariadbIcon, label: 'MariaDB' },
      { src: slim4Icon, label: 'SLIM4' },
      { src: phpstormIcon, label: 'PHPStorm' },
      { src: filezillaIcon, label: 'FileZilla' },
    ],
  },
];
---

<section>
  <div class="max-w-6xl mx-auto px-4 sm:px-6">
    <div class="py-12">
      <div class="py-4 sm:py-6 lg:py-8">
        <div class="flex flex-wrap md:-mx-8">
          <div class="w-full lg:w-1/3 px-0 sm:px-8">
            <div class="mb-12">
              <h2 class="mb-4 text-3xl lg:text-4xl font-bold font-heading">Extras</h2>
              <p class="mb-6 text-xl text-gray-600 dark:text-slate-400">Want to see something else?</p>
            </div>
          </div>
          <div class="w-full px-0 sm:px-8">
            <ul class="grid lg:grid-cols-2 grid-cols-1 gap-y-6 lg:gap-y-0">
              {
                extras.map((item, index) => (
                  <li
                    class={`flex ${index === 0 ? 'col-span-2 lg:pb-10' : ''} intersect-once intersect-quarter motion-safe:md:opacity-0 motion-safe:md:intersect:animate-fade`}
                  >
                    <div class="pr-4 sm:pl-4 hidden md:flex">
                      <span class="flex w-16 h-16 mx-auto items-center justify-center text-2xl font-bold rounded-full bg-slate-100 dark:bg-slate-800 text-primary">
                        {index + 1}
                      </span>
                    </div>
                    <Image class={item.imageClass} src={item.image} sizes="100vw" alt={item.imageAlt} loading="lazy" />
                    <div class="px-4">
                      {item.githubUrl || item.liveUrl ? (
                        <a
                          class="mb-4 text-xl font-semibold font-heading hover:underline cursor-pointer"
                          href={item.githubUrl ?? item.liveUrl}
                          target="_blank"
                        >
                          {item.title}
                        </a>
                      ) : (
                        <div class="mb-4 text-xl font-semibold font-heading">{item.title}</div>
                      )}
                      <p class="text-gray-500 dark:text-gray-400">{item.description}</p>
                      <div class="grid max-w-none grid-cols-6 sm:flex-row sm:justify-center pt-4">
                        {item.skills.map((skill) => (
                          <div class="group cursor-pointer relative inline-block text-center px-0.5">
                            <Image loading="lazy" src={skill.src} alt={skill.label} width={100} height={100} />
                            <div class="absolute bottom-0 flex-col items-center hidden mb-6 group-hover:flex">
                              <span class="relative z-10 p-3 text-xs leading-none rounded-lg text-white whitespace-no-wrap bg-gradient-to-r from-blue-500 to-blue-600 shadow-lg">
                                {skill.label}
                              </span>
                            </div>
                          </div>
                        ))}
                      </div>
                      <div class="grid grid-cols-1 lg:gap-x-2 mt-6">
                        {item.liveUrl ? (
                          <a
                            class="btn text-white border border-primary bg-primary hover:bg-primary hover:border-primary mb-4"
                            href={item.liveUrl}
                            target="_blank"
                          >
                            <Icon name="tabler:external-link" class="w-5 h-5 mr-1 -ml-1.5" /> Live
                          </a>
                        ) : null}
                        {item.githubUrl ? (
                          <a
                            class="btn text-white border bg-gray-900 hover:bg-gray-700 dark:bg-gray-700 dark:hover:bg-gray-800 mb-4"
                            href={item.githubUrl}
                            target="_blank"
                          >
                            <Icon name="tabler:brand-github" class="w-5 h-5 mr-1 -ml-1.5" /> Github
                          </a>
                        ) : (
                          <div class="btn text-white border bg-gray-600 hover:bg-gray-600 dark:bg-gray-600 dark:hover:bg-gray-800 mb-4">
                            <Icon name="tabler:lock" class="w-5 h-5 mr-1 -ml-1.5" /> Github
                          </div>
                        )}
                      </div>
                    </div>
                  </li>
                ))
              }
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
