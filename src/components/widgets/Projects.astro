---
import { Icon } from 'astro-icon/components';
import { Image } from 'astro:assets';

// Static imports for large project images and frequently-used skill icons.
import premThumb from '~/assets/images/prempredictions_thumb.webp';
import spouraThumb from '~/assets/images/spoura_portfolio.webp';
import filmfrontThumb from '~/assets/images/filmfront_thumb.webp';
import cronizeThumb from '~/assets/images/cronize_thumb.webp';

import iconTailwind from '~/assets/skills/icons/tailwindcss-original.svg';
import iconDjango from '~/assets/skills/icons/django-plain.svg';
import iconPython from '~/assets/skills/icons/python-original.svg';
import iconCockroach from '~/assets/skills/icons/cockroachdb-plain.svg';
import iconHtmx from '~/assets/skills/icons/htmx_icon.webp';
import iconTypescript from '~/assets/skills/icons/typescript-original.svg';
import iconReact from '~/assets/skills/icons/react-original.svg';
import iconNext from '~/assets/skills/icons/nextjs-original.svg';
import iconAstro from '~/assets/skills/icons/astro-light.svg';
import iconSupabase from '~/assets/skills/icons/supabase-plain.svg';
import iconTurso from '~/assets/skills/icons/turso-plain.png';
import iconGo from '~/assets/skills/icons/go-plain.svg';
import iconVite from '~/assets/skills/icons/vite-plain.svg';
import iconPreact from '~/assets/skills/icons/preact-plain.svg';
import type ImageMetadata from 'astro:assets';

type Project = {
  title: string;
  description: string;
  image: ImageMetadata;
  imageBgClass: string;
  liveUrl: string | null;
  liveIcon?: string;
  githubUrl: string | null;
  skills: Skill[];
};

type Skill = {
  src: ImageMetadata;
  label: string;
};

// Centralised project data to make edits easy: title, description, images, links and skills.
const projects: Project[] = [
  {
    title: 'PremPredict',
    description:
      'University final year project; predict upcoming Premier League fixtures per gameweek and directly compare scores across the league season.',
    image: premThumb,
    imageBgClass: 'bg-slate-900 text-slate-100',
    liveUrl: 'https://prempredict.vercel.app/',
    liveIcon: 'tabler:ball-football',
    githubUrl: null, // private for now
    skills: [
      { src: iconTailwind, label: 'Tailwind' },
      { src: iconDjango, label: 'Django' },
      { src: iconPython, label: 'Python' },
      { src: iconCockroach, label: 'CockroachDB' },
      { src: iconHtmx, label: 'HTMX' },
    ],
  },
  {
    title: 'Spoura',
    description:
      'Fully featured ecommerce application, favourite and add shoes to your cart. Sort products using price, brand, type and search for your preferred fit.',
    image: spouraThumb,
    imageBgClass: 'bg-slate-100 text-slate-900',
    liveUrl: 'https://spoura-frontend.vercel.app/',
    liveIcon: 'tabler:basket',
    githubUrl: 'https://github.com/mtlh/SpouraPreactGo',
    skills: [
      { src: iconTailwind, label: 'Tailwind' },
      { src: iconTypescript, label: 'TypeScript' },
      { src: iconPreact, label: 'Preact' },
      { src: iconVite, label: 'Vite' },
      { src: iconGo, label: 'Go' },
      { src: iconTurso, label: 'Turso' },
    ],
  },
  {
    title: 'FilmFront',
    description:
      'Movie site made using TMDb API that allows users to search new movies, tv shows and actors, create lists and answer trivia questions.',
    image: filmfrontThumb,
    imageBgClass: 'bg-zinc-900 text-slate-100',
    liveUrl: 'https://filmfront.vercel.app/',
    liveIcon: 'tabler:movie',
    githubUrl: 'https://github.com/mtlh/FilmFront',
    skills: [
      { src: iconTailwind, label: 'Tailwind' },
      { src: iconTypescript, label: 'TypeScript' },
      { src: iconReact, label: 'React' },
      { src: iconNext, label: 'Nextjs' },
      { src: iconSupabase, label: 'Supabase' },
    ],
  },
  {
    title: 'Cronize',
    description:
      'Manage projects, schedule custom cronjobs and view history. Try out the request playground to test the output without running on a schedule.',
    image: cronizeThumb,
    imageBgClass: 'bg-slate-100 text-slate-900',
    liveUrl: 'https://cronize.vercel.app/',
    liveIcon: 'tabler:tool',
    githubUrl: 'https://github.com/mtlh/cronize',
    skills: [
      { src: iconTailwind, label: 'Tailwind' },
      { src: iconTypescript, label: 'TypeScript' },
      { src: iconReact, label: 'React' },
      { src: iconTurso, label: 'Turso' },
      { src: iconAstro, label: 'Astro' },
    ],
  },
];
---

<section class="bg-light" id="projects">
  <div class="px-4 py-8 mx-auto max-w-6xl lg:px-8 lg:py-10">
    <div class="max-w-xl mb-10 md:mx-auto text-center lg:max-w-2xl md:mb-12">
      <p class="text-base text-primary dark:text-primary font-semibold tracking-wide uppercase">Projects</p>
      <h2 class="text-4xl md:text-5xl font-bold leading-tighter tracking-tighter mb-4 font-heading">
        What I have made
      </h2>
      <p class="max-w-3xl mx-auto sm:text-center text-xl text-gray-600 dark:text-slate-400">
        My best fully featured applications.
      </p>
    </div>
    <div class="grid items-stretch gap-6 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 my-12 antialiased">
      {
        projects.map((project) => (
          <div class="relative flex h-full flex-col p-2 intersect-once intersect-quarter motion-safe:md:opacity-0 motion-safe:md:intersect:animate-fade">
            <div class={`mockup-window border ${project.imageBgClass}`}>
              <Image
                class="flex justify-center w-full object-cover object-center rounded-lg shadow-md"
                src={project.image}
                widths={[377, 516, 688, 900]}
                sizes="100vw"
                alt={project.title}
                loading="lazy"
              />
            </div>
            <div class="relative px-4 -mt-16">
              <div class="bg-white dark:bg-slate-900 p-6 rounded-lg shadow-xl h-80">
                <div class="mb-6 mt-1">
                  <h3 class="mb-4 text-3xl font-bold">{project.title}</h3>
                  <div class="grid grid-cols-2 gap-x-2">
                    {project.liveUrl ? (
                      <a
                        class="btn text-white border border-primary bg-primary hover:bg-primary hover:border-primary mb-4"
                        href={project.liveUrl}
                        target="_blank"
                      >
                        <Icon name={project.liveIcon} class="w-5 h-5 mr-1 -ml-1.5" /> Live
                      </a>
                    ) : null}
                    {project.githubUrl ? (
                      <a
                        class="btn text-white border bg-gray-900 hover:bg-gray-700 dark:bg-gray-700 dark:hover:bg-gray-800 mb-4"
                        href={project.githubUrl}
                        target="_blank"
                      >
                        <Icon name="tabler:brand-github" class="w-5 h-5 mr-1 -ml-1.5" /> Github
                      </a>
                    ) : (
                      <div class="btn text-white border bg-gray-600 hover:bg-gray-600 dark:bg-gray-600 dark:hover:bg-gray-800 mb-4">
                        <Icon name="tabler:lock" class="w-5 h-5 mr-1 -ml-1.5" /> Github
                      </div>
                    )}
                  </div>
                  <p class="mb-4">{project.description}</p>
                  <div class="grid max-w-none grid-cols-6 lg:grid-cols-8 sm:flex-row sm:justify-center gap-4">
                    {project.skills.map((skill) => (
                      <div class="group cursor-pointer relative inline-block text-center">
                        <Image loading="lazy" src={skill.src} alt={skill.label} width={100} height={100} />
                        <div class="absolute bottom-0 flex-col items-center hidden mb-6 group-hover:flex">
                          <span class="relative z-10 p-3 text-xs leading-none rounded-lg text-white whitespace-no-wrap bg-gradient-to-r from-blue-500 to-blue-600 shadow-lg">
                            {skill.label}
                          </span>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            </div>
          </div>
        ))
      }
    </div>
  </div>
</section>
